% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_pdp.R
\name{plot_pdp}
\alias{plot_pdp}
\title{Create Partial Dependence Plot with Individual Conditional Expectation Lines}
\usage{
plot_pdp(
  data,
  model,
  response,
  x_var,
  verbose = FALSE,
  gridSize = 10,
  nmax = 500,
  nIce = 30,
  limits = NULL,
  colorVar = NULL,
  probability = FALSE,
  borders = NULL,
  category_colors = NULL,
  category_alpha = 0.5,
  category_names = NULL,
  title = "Partial Dependence Plot with Individual Conditional Expectation Lines",
  subtitle = "Background colors show category mapping",
  ice_alpha = 0.4,
  ice_color = "purple",
  ice_linewidth = 0.7,
  pdp_color = "black",
  pdp_linewidth = 1.5,
  ridgeline_scale = 0.8,
  ridgeline_alpha = 0.7
)
}
\arguments{
\item{data}{A data frame containing the predictor variables and the response.}

\item{response}{Character string. The name of the response variable in \code{data}.}

\item{x_var}{Character string specifying the name of the predictor variable to plot.}

\item{verbose}{Logical. If \code{TRUE}, returns a list with both data and plot. 
If \code{FALSE} (default), returns only the plot.}

\item{gridSize}{Integer. Number of points to evaluate in the grid for each variable. Default is 10.}

\item{nmax}{Integer. Maximum number of rows sampled from \code{data} for ICE computation. Default is 500.}

\item{nIce}{Integer. Number of ICE curves to sample. Default is 30.}

\item{limits}{Optional numeric vector of y-axis limits. If \code{NULL}, computed from the data.}

\item{colorVar}{Optional variable name for colouring ICE curves (instead of prediction values).}

\item{probability}{Logical. Whether to use probability predictions. Default is \code{FALSE}.}

\item{borders}{Numeric vector of category borders for continuous variables. 
If NULL, no background category mapping is shown. Default is NULL.}

\item{category_colors}{Character vector of colors for category backgrounds. 
If NULL, uses default color palette.}

\item{category_alpha}{Numeric value between 0 and 1 for category background transparency. 
Default is 0.5.}

\item{category_names}{Character vector of category names for the legend. 
If NULL, uses default names.}

\item{title}{Character string for the plot title. Default is "Partial Dependence 
Plot with Individual Conditional Expectation Lines".}

\item{subtitle}{Character string for the plot subtitle. Default is "Background 
colors show category mapping".}

\item{ice_alpha}{Numeric value between 0 and 1 for ICE line transparency. 
Default is 0.4.}

\item{ice_color}{Character string specifying the color of ICE lines. Default is "purple".}

\item{ice_linewidth}{Numeric value for the width of ICE lines. Default is 0.7.}

\item{pdp_color}{Character string specifying the color of the PDP mean line and points. 
Default is "black".}

\item{pdp_linewidth}{Numeric value for the width of the PDP mean line. Default is 1.5.}

\item{ridgeline_scale}{Numeric value controlling the height scaling of ridgeline 
plots for categorical variables. Default is 0.8.}

\item{ridgeline_alpha}{Numeric value between 0 and 1 for ridgeline transparency 
in categorical plots. Default is 0.7.}

\item{fit}{A fitted \code{ranger} model object.}
}
\value{
If \code{verbose = FALSE}, returns a ggplot object. If \code{verbose = TRUE}, 
  returns a list with elements:
  \item{plot}{The ggplot object}
  \item{data}{List containing ice_data and pdp_data tibbles}
  \item{variable_type}{Character indicating whether variable was treated as "categorical" or "continuous"}
}
\description{
This function creates partial dependence plots (PDP) with individual conditional 
expectation (ICE) lines for ordinal random forest models. It automatically detects 
whether the predictor variable is continuous or categorical and creates appropriate 
visualizations. For continuous variables, it shows ICE lines with optional category 
background mapping. For categorical variables, it creates ridgeline plots showing 
the distribution of predictions for each category.
}
\details{
The function automatically detects the variable type based on the original data:
\itemize{
  \item \strong{Categorical treatment}: Variables are treated as categorical if they are 
    factors, characters, or have 4 or fewer unique values. A warning is displayed 
    when numeric variables are treated as categorical due to having few unique values.
  \item \strong{Continuous variables}: Creates a traditional PDP with ICE lines, 
    PDP mean line, and optional category background mapping using the \code{borders} parameter.
  \item \strong{Categorical variables}: Creates ridgeline plots showing the 
    distribution of ICE predictions for each category level, with PDP mean points.
}
}
\examples{
\dontrun{
# Basic usage - just get the plot
plot <- plot_pdp(
  data = dm_train_dummy, 
  fit = rf_ord_dummy$ranger.fit,
  response = "score",
  var = "item01"
)

# Verbose usage - get plot, data, and variable type info
result <- plot_pdp(
  data = dm_train_dummy, 
  fit = rf_ord_dummy$ranger.fit,
  response = "score",
  var = "item01",
  verbose = TRUE
)

print(result$plot)
head(result$data$ice_data)
}

}
